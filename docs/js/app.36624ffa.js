(function(t){function e(e){for(var n,s,l=e[0],i=e[1],c=e[2],d=0,f=[];d<l.length;d++)s=l[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&f.push(o[s][0]),o[s]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);u&&u(e);while(f.length)f.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,l=1;l<a.length;l++){var i=a[l];0!==o[i]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},o={app:0},r=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=i;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"00d2":function(t,e,a){"use strict";(function(t){e["a"]={state:{data:{}},actions:{loadDeal:function(e){var a=e.commit,n=e.getters;t.request({url:"/api/contracts",headers:{Authorization:n.getAuthStr},resolve:function(t){a("saveDeals",t)},reject:function(t){console.log(t)}})}},mutations:{saveDeals:function(t,e){t.data=e}},getters:{getDeals:function(t){return t.data}}}}).call(this,a("c8ba"))},"0c4e":function(t,e,a){},"0f9a":function(t,e,a){"use strict";(function(t){e["a"]={state:{authStr:localStorage.getItem("access_token")&&localStorage.getItem("token_type")?localStorage.getItem("token_type")+" "+localStorage.getItem("access_token"):null,role:null},actions:{login:function(e,a){var n=e.commit,o=e.dispatch;t.request({url:"/oauth/token",method:"post",data:{username:a.mail,password:a.password,client_id:1,client_secret:"c75IGwuqkjrO1RWCE4Ntn4zqpQdpgnEO2wGT9iMT",grant_type:"password"},headers:{},resolve:function(t){localStorage.setItem("access_token",t.access_token),localStorage.setItem("expires_in",t.expires_in),localStorage.setItem("refresh_token",t.refresh_token),localStorage.setItem("token_type",t.token_type),n("setUserLogin",{token_type:t.token_type,access_token:t.access_token}),o("loadUserData")},reject:function(t){"invalid_credentials"==t.error?n("showModal",{header:"Авторизация",content:"E-mail или пароль были указаны не верно. Пожалуйста, проверьте правильность заполнения и повторите попытку."}):(console.warn(t.error),n("showModal",{header:"Авторизация",content:"При отправке запроса произошла ошибка."}))}})},loadUserData:function(e){var a=e.commit,n=e.state;t.request({url:"/api/profile",headers:{Authorization:n.authStr},resolve:function(t){a("addPath",{path:"/",title:1==t.role?"Контракты":"Объекты"}),a("setUserRole",t.role)},reject:function(t){console.warn(t.error),a("logout"),a("showModal",{header:"Авторизация",content:"При отправке запроса произошла ошибка."})}})}},mutations:{setUserLogin:function(t,e){t.authStr=e.token_type+" "+e.access_token},setUserRole:function(t,e){t.role=e},logout:function(t){localStorage.removeItem("access_token"),localStorage.removeItem("expires_in"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_type"),t.authStr=null,t.role=null}},getters:{isUserLogined:function(t){return null!=t.authStr},getAuthStr:function(t){return t.authStr},getUserRole:function(t){return t.role}}}}).call(this,a("c8ba"))},2179:function(t,e,a){},"3dfd":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("header",{staticClass:"header"},[a("h1",{staticClass:"header_title"},[a("router-link",{attrs:{to:"/"}},[t._v("Clerc")])],1),t.$store.getters.isUserLogined?a("nav",{staticClass:"header_nav"},[a("button",{staticClass:"header_nav-button icon icon_users",attrs:{type:"button",title:"Пользователи"}}),a("button",{staticClass:"header_nav-button icon icon_logout",attrs:{type:"button",title:"Выйти"},on:{click:function(e){t.$store.commit("logout"),t.$store.commit("clearBreadcrumbs")}}})]):t._e()]),a("main",{staticClass:"app-container"},[t.$store.getters.isUserLogined?t._e():a("login"),t.$store.getters.isUserLogined?a("breadcrumbs"):t._e(),t.$store.getters.isUserLogined?a("router-view"):t._e()],1),a("modal")],1)},o=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-form_wrapper"},[a("form",{staticClass:"login-form",on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[a("h2",{staticClass:"login-form_app-title mb-15"},[t._v("Clerc")]),a("p",{staticClass:"mb-15"},[t._v("Авторизация")]),a("div",{staticClass:"mh-60"},[a("Input",{staticClass:"mb-15",attrs:{label:"E-mail",placeholder:"exemple@mail.com",type:"text"},model:{value:t.mail,callback:function(e){t.mail=e},expression:"mail"}}),a("Input",{staticClass:"mb-30",attrs:{label:"Пароль",placeholder:"Введите Ваш пароль",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),a("button",{staticClass:"login-form_submit button",attrs:{type:"submit"}},[t._v("Войти в систему")])],1)])])},s=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"input",attrs:{title:t.tooltip}},[a("p",{staticClass:"input_label"},[t._v(t._s(t.label))]),"checkbox"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.$attrs.value,expression:"$attrs.value"}],staticClass:"input_value",attrs:{placeholder:t.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(t.$attrs.value)?t._i(t.$attrs.value,null)>-1:t.$attrs.value},on:{input:function(e){return t.$emit("input",e.target.value)},change:function(e){var a=t.$attrs.value,n=e.target,o=!!n.checked;if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&t.$set(t.$attrs,"value",a.concat([r])):s>-1&&t.$set(t.$attrs,"value",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.$attrs,"value",o)}}}):"radio"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.$attrs.value,expression:"$attrs.value"}],staticClass:"input_value",attrs:{placeholder:t.placeholder,type:"radio"},domProps:{checked:t._q(t.$attrs.value,null)},on:{input:function(e){return t.$emit("input",e.target.value)},change:function(e){return t.$set(t.$attrs,"value",null)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.$attrs.value,expression:"$attrs.value"}],staticClass:"input_value",attrs:{placeholder:t.placeholder,type:t.type},domProps:{value:t.$attrs.value},on:{input:[function(e){e.target.composing||t.$set(t.$attrs,"value",e.target.value)},function(e){return t.$emit("input",e.target.value)}]}})])},i=[],c={props:["tooltip","label","placeholder","type"]},u=c,d=(a("af2d"),a("2877")),f=Object(d["a"])(u,l,i,!1,null,"1d83b282",null),p=f.exports,m={components:{Input:p},data:function(){return{mail:"",password:""}},methods:{login:function(){""==this.mail||""==this.password?this.$store.commit("showModal",{header:"Авторизация",content:"Вы не указали Ваш E-mail или пароль. Пожалуйста, убедитесь в том, что поля E-mail и пароль заполнены и повторите попытку."}):this.$store.dispatch("login",{mail:this.mail,password:this.password})}}},h=m,v=(a("46ea"),Object(d["a"])(h,r,s,!1,null,null,null)),b=v.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.$store.getters.getModalShowState?a("div",[a("div",{class:"modal_background fade "+(t.fadeOut?" fade_out":"")}),a("div",{class:"modal_wrapper fade "+(t.fadeOut?" fade_out":"")},[a("div",{staticClass:"modal"},[a("header",{staticClass:"modal_header"},[a("h3",{staticClass:"mb-15"},[t._v(t._s(t.$store.getters.getModalHeader))]),a("button",{staticClass:"modal_close icon icon_close",on:{click:t.closeModal}})]),a("div",{staticClass:"modal_content mb-15"},[t._v(" "+t._s(t.$store.getters.getModalContent)+" ")]),a("footer",{staticClass:"modal_footer"},[a("button",{staticClass:"button modal_submit",on:{click:t.submitModal}},[t._v("Хорошо")])])])])]):t._e()},_=[],$={data:function(){return{fadeOut:!1}},methods:{closeModal:function(){var t=this;this.fadeOut=!0,setTimeout((function(){t.$store.commit("hideModal"),t.fadeOut=!1}),300)},submitModal:function(){var t=this;this.fadeOut=!0,setTimeout((function(){t.$store.commit("submitModal"),t.fadeOut=!1}),300)}}},k=$,w=(a("b338"),Object(d["a"])(k,g,_,!1,null,null,null)),y=w.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"breadcrumbs"},["/"!=t.$route.path?a("div",{staticClass:"breadcrumbs_toMainPage",on:{click:function(e){return t.$store.commit("goPath",0)}}},[a("router-link",{attrs:{to:"/"}},[a("i",{staticClass:"icon icon_back"}),t._v("На главную")])],1):t._e(),a("div",{staticClass:"breadcrumbs_items"},t._l(t.$store.getters.getPathArray,(function(e,n){return a("div",{key:n,staticClass:"breadcrumbs_item",on:{click:function(e){return t.$store.commit("goPath",n)}}},[a("router-link",{attrs:{to:e.path}},[t._v(" "+t._s(e.title)+" ")])],1)})),0)])},O=[],S=(a("70cd"),{}),j=Object(d["a"])(S,C,O,!1,null,null,null),x=j.exports,M={components:{login:b,modal:y,breadcrumbs:x},created:function(){this.$store.getters.isUserLogined&&this.$store.dispatch("loadUserData")}},P=M,E=Object(d["a"])(P,n,o,!1,null,null,null);e["a"]=E.exports},4360:function(t,e,a){"use strict";var n=a("2b0e"),o=a("2f62"),r=a("5530"),s=a("00d2"),l={deals:s["a"]},i=a("0f9a"),c={state:{isShow:!1,header:"Сообщение системы",content:"Текстовое содержимое модального окна",submit:function(){}},getters:{getModalShowState:function(t){return t.isShow},getModalHeader:function(t){return t.header},getModalContent:function(t){return t.content}},mutations:{showModal:function(t,e){t.header=e.header,t.content=e.content,t.submit=e.submit,t.isShow=!0},submitModal:function(t){t.isShow=!1,t.submit&&t.submit()},hideModal:function(t){t.isShow=!1}}},u=(a("a434"),{state:{urls:[]},mutations:{addPath:function(t,e){t.urls.push(Object(r["a"])({},e))},goPath:function(t,e){t.urls.splice(e+1)},clearBreadcrumbs:function(t){t.urls=[]}},getters:{getPathArray:function(t){return t.urls},getPathsCount:function(t){return t.urls.length},getCurrentPath:function(t){return t.urls[t.urls.length-1]}}}),d=Object(r["a"])(Object(r["a"])({},l),{},{user:i["a"],modal:c,breadcrumbs:u});n["a"].use(o["a"]);e["a"]=new o["a"].Store({state:{},mutations:{},actions:{},modules:d})},"46ea":function(t,e,a){"use strict";var n=a("e57d"),o=a.n(n);o.a},4934:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e),function(t){a("e260"),a("e6cf"),a("cca6"),a("a79d");var e=a("2b0e"),n=(a("abe2"),a("3dfd")),o=(a("ddb8"),a("a18c")),r=a("4360"),s=a("bd92");e["a"].config.productionTip=!1,t.request=s["a"],new e["a"]({router:o["a"],store:r["a"],render:function(t){return t(n["a"])}}).$mount("#app")}.call(this,a("c8ba"))},"70cd":function(t,e,a){"use strict";var n=a("4934"),o=a.n(n);o.a},"7b98":function(t,e,a){"use strict";var n=a("2179"),o=a.n(n);o.a},"91c2":function(t,e,a){},a18c:function(t,e,a){"use strict";var n=a("2b0e"),o=a("8c4f"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[1==t.$store.getters.getUserRole?a("adminDashboard"):t._e(),0==t.$store.getters.getUserRole?a("watcherDashboard"):t._e()],1)},s=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vueTable",{attrs:{data:t.$store.getters.getDeals,link:"/deal/"}})},i=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return this.data.length>0?a("table",[a("tr",t._l(Object.keys(this.data[0]),(function(e){return a("th",{key:e},[t._v(t._s(e))])})),0),t._l(this.data,(function(e,n){return a("tr",{key:n},t._l(Object.keys(e),(function(n,o){return a("td",{key:o},[t.link?a("router-link",{attrs:{to:t.link+e["id"]}},[t._v(" "+t._s(e[n])+" ")]):a("span",[t._v(t._s(e[n]))])],1)})),0)}))],2):a("div",[t._v("Таблица пуста")])},u=[],d={props:["data","link"]},f=d,p=(a("7b98"),a("2877")),m=Object(p["a"])(f,c,u,!1,null,null,null),h=m.exports,v={components:{vueTable:h},created:function(){this.$store.dispatch("loadDeal")}},b=v,g=Object(p["a"])(b,l,i,!1,null,null,null),_=g.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h1",[t._v("Watcher dashboard")])},k=[],w={},y=Object(p["a"])(w,$,k,!1,null,null,null),C=y.exports,O={components:{adminDashboard:_,watcherDashboard:C}},S=O,j=Object(p["a"])(S,r,s,!1,null,null,null),x=j.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t._v("Просмотр контрактов")])},P=[],E={},U=Object(p["a"])(E,M,P,!1,null,null,null),I=U.exports;n["a"].use(o["a"]);var D=[{path:"/",name:"mainPage",component:x},{path:"/deal/:id",name:"dealView",component:I}],A=new o["a"]({mode:"history",base:"/",routes:D});e["a"]=A},abe2:function(t,e,a){},af2d:function(t,e,a){"use strict";var n=a("91c2"),o=a.n(n);o.a},b338:function(t,e,a){"use strict";var n=a("0c4e"),o=a.n(n);o.a},bd92:function(t,e,a){"use strict";var n=a("5530"),o=a("bc3a"),r=a.n(o),s="https://clerc.dgz.ru";e["a"]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.url,a=t.method,o=void 0===a?"get":a,l=t.data,i=void 0===l?{}:l,c=t.headers,u=void 0===c?{"Content-Type":"multipart/form-data"}:c,d=t.config,f=void 0===d?{}:d,p=t.reject,m=void 0===p?function(t){return console.warn("Request error!\nURL: "+s+e+"\nError:\n"+t),!1}:p,h=t.resolve,v=void 0===h?function(t){return console.log(t)}:h;r()(Object(n["a"])({method:o,url:s+e,data:i,headers:u},f)).then((function(t){t.data.error||0==t.data.success?m(t.data):t.data.data?v(t.data.data):v(t.data)})).catch((function(t){t.response?m(t.response.data):m(t)}))}},ddb8:function(t,e,a){"use strict";var n=a("9483");Object(n["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}})},e57d:function(t,e,a){}});
//# sourceMappingURL=app.36624ffa.js.map